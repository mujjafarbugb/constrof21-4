import{u as S,r as i,Q as g,j as a,a as e,F as _}from"./index.81de7608.js";import"./index.esm.b0dae23c.js";import{B}from"./index.ec51c02f.js";import{M as v,B as y}from"./Modal.c4889181.js";import{T as c}from"./Textinput.5c99e78c.js";import{b as O}from"./index.b3e2825e.js";import{a as m}from"./axios.74c9240f.js";import"./iconBase.a00758a9.js";const M=()=>{S();const[p,h]=i.exports.useState(!1),[d,k]=i.exports.useState([]),[x,C]=i.exports.useState([]),[l,s]=i.exports.useState({client:"",project:"",scope:"",scopeId:"",billValue:"",workValue:"",workCompleted:"",isCompleted:!1,remark:""}),w=localStorage.getItem("user"),j=JSON.parse(w),N=localStorage.getItem("profile"),f=JSON.parse(N);i.exports.useEffect(()=>{m.get(`https://constrobackend17-4.onrender.com/api/get_service_provider_regid/${j.user._id}`).then(t=>{if(console.log(66,t),!t.data.Result)g.error(t.data.message);else{h(!0),console.log("Data Fetch",t.data.Result);const r=t.data.Result.projectList.filter(u=>u.isCompleted===!1);console.log(22,r);const n=t.data.Result;console.log("Show Data",n.projectList),k(r)}}).catch(t=>{console.log(t)}),m.get("https://constrobackend17-4.onrender.com/api/get_all_expertise").then(t=>{console.log(t.data.Result),C(t.data.Result)}).catch(t=>{console.error("Error fetching expertise data:",t)})},[p]);const V=()=>{const t={projectList:[...d,{...l}]};console.log(72,t),m.put(`https://constrobackend17-4.onrender.com/api/update_Service_Provider/${f._id}`,t).then(o=>{console.log("res",o)}).catch(o=>{console.log(o)}),h(!p)},b=t=>{const o=t.target.value,r=x.find(n=>String(n._id)===String(o));console.log("Selected Scope:",r),s({...l,scope:r.expertise,scopeId:r._id})},F=t=>{d[t];const o=d.filter((n,u)=>u!==t);console.log(o);const r={projectList:o};console.log(72,r),m.put(`https://constrobackend17-4.onrender.com/api/update_Service_Provider/${f._id}`,r).then(n=>{console.log("res",n)}).catch(n=>{console.log(n)}),h(!p)},P=t=>{const o=parseFloat(t.target.value),r=parseFloat(l.billValue);if(isNaN(o))s({...l,workValue:"",workCompleted:""});else if(o>r){const n=(r/o*100).toFixed(2);s({...l,workValue:o,workCompleted:n})}else s({...l,workValue:o,workCompleted:""}),g.error("Work Order Value must be greater than Bill Value")};return a("div",{className:"shadow-md p-4",children:[a("div",{className:"flex justify-between items-center",children:[e("span",{className:"my-4 text-lg font-semibold text-slate-500",children:"Ongoing Projects"}),e("div",{children:e(v,{title:"",label:"Add Projects + ",labelClass:"bg-[#00adee] hover:bg-[#6fcaeb] text-white",uncontrol:!0,footerContent:e(y,{text:"Add Project",className:"w-full bg-[#00adee] hover:bg-[#6fcaeb] text-white",onClick:()=>{V()}}),children:a("div",{className:"text-base text-slate-600 dark:text-slate-300 mt-2",children:[e(c,{label:"Client name",type:"text",placeholder:"",value:l.client,onChange:t=>s({...l,client:t.target.value})}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Project name"}),e(c,{type:"text",placeholder:"",class:"my-2",value:l.project,onChange:t=>s({...l,project:t.target.value})})]}),a("div",{className:"input-group mt-2",children:[e("label",{htmlFor:"cityInput",className:"form-label",children:"Select Expertise"}),a("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"expertiseId",value:l.scopeId,onChange:b,children:[e("option",{value:"",children:"Select Expertise"})," ",x.map(t=>e("option",{value:t._id,children:t.expertise},t._id))]})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"City"}),e(c,{type:"text",placeholder:"",class:"my-2",value:l.city,onChange:t=>s({...l,city:t.target.value})})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Location"}),e(c,{type:"text",placeholder:"",class:"my-2",value:l.location,onChange:t=>s({...l,location:t.target.value})})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Bill Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.billValue,onChange:t=>s({...l,billValue:t.target.value})})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Work Order Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.workValue,onChange:P})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Work Completed(%)"}),e(c,{type:"text",placeholder:"\u20B9",value:l.workCompleted,defaultValue:l.workCompleted,onChange:t=>s({...l,workCompleted:t.target.value})})]}),a("div",{class:"mb-2  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Remark"}),e(c,{type:"text",placeholder:"",value:l.remark,onChange:t=>s({...l,remark:t.target.value})})]})]})})})]}),e("div",{class:"overflow-x-auto",children:a("table",{class:"table-auto w-full shadow-sm rounded-md mt-3",children:[e("thead",{class:"border border-collapse bg-[#00adee] text-white",children:a("tr",{className:" rounded-md",children:[e("th",{class:"px-4 py-2 text-center border",children:"Client"}),e("th",{class:"px-4 py-2 text-center border",children:"Projects"}),e("th",{class:"px-4 py-2 text-center border",children:"Scope"}),e("th",{class:"px-4 py-2 text-center border",children:"Bill Value"}),e("th",{class:"px-4 py-2 text-center border",children:"Work Order Value"}),e("th",{class:"px-4 py-2 text-center border",children:"Work Completed(%)"}),e("th",{class:"px-4 py-2 text-center border",children:"Remark"}),e("th",{class:"px-4 py-2 text-center border",children:"Action"})]})}),e("tbody",{children:d==null?void 0:d.map((t,o)=>e(_,{children:a("tr",{className:"hover:bg-[#f8f8f8] shadow-sm",children:[e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.client}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.project}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.scope}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.billValue}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.workValue}),a("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:[t.workCompleted,"%"]}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.remark}),a("td",{className:"px-4 py-2 text-center flex justify-center text-sm text-slate-500",children:[e("div",{className:"cursor-pointer hover:text-[#00adee]",children:e(v,{title:"",label:e(B,{className:"text-3xl text-slate-400 hover:text-[#00adee]"}),labelClass:"",uncontrol:!0,footerContent:e(y,{text:"Update Project",className:"w-full bg-[#00adee] hover:bg-[#6fcaeb] text-white"}),children:a("div",{className:"text-base text-slate-600 dark:text-slate-300 mt-2",children:[e("label",{for:"projectName",class:"form-label text-left",children:"Client name"}),e("div",{className:"shadow-sm p-2",children:e("span",{className:"text-slate-500 text-sm ",children:l.client})}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Project name"}),e("div",{className:"shadow-sm p-2",children:e("span",{className:"text-slate-500 text-sm ",children:l.project})})]}),a("div",{className:"input-group mt-2",children:[e("label",{htmlFor:"cityInput",className:"form-label",children:"Select Expertise"}),a("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"expertiseId",value:l.scopeId,onChange:b,children:[e("option",{value:"",children:"Select Expertise"})," ",x.map(r=>e("option",{value:r._id,children:r.expertise},r._id))]})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"City"}),e("div",{className:"shadow-sm p-2",children:e("span",{className:"text-slate-500 text-sm ",children:l.city})})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Location"}),e("div",{className:"shadow-sm p-2",children:e("span",{className:"text-slate-500 text-sm ",children:l.location})})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Bill Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.billValue,onChange:r=>s({...l,billValue:r.target.value})})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Work Order Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.workValue,onChange:r=>s({...l,workValue:r.target.value})})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Work Completed(%)"}),e(c,{type:"text",placeholder:"%",value:l.workCompleted,onChange:r=>s({...l,workCompleted:r.target.value})})]}),a("div",{class:"mb-2  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Remark"}),e(c,{type:"text",placeholder:"",value:l.remark,onChange:r=>s({...l,remark:r.target.value})})]})]})})}),e("td",{class:"px-4 py-2 text-sm text-slate-500 flex justify-center",children:e("button",{onClick:()=>F(o),children:e(O,{className:"text-3xl cursor-pointer text-slate-400 hover:text-red-500"})})})]})]})}))})]})})]})};export{M as default};
