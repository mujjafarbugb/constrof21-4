import{u as Ce,r as n,Q as y,a,j as s,F as G}from"./index.81de7608.js";import"./index.esm.b0dae23c.js";import{c as Se}from"./camPic.50111723.js";import{c as Ie,a as h,b as ke,u as Ee,o as Pe}from"./array.c4379bca.js";import{T as m}from"./Textinput.5c99e78c.js";import{u as _e}from"./formik.esm.a73e9a74.js";import{a as v}from"./axios.74c9240f.js";const j=Ie({firmtype:h().required("Please select a firm type."),represent:h().required("Feild is Required."),designation:h().required("Designation is Required."),username:h().required("Username is Required."),homecity:h().required("Home city is Required."),opcity:ke().min(1,"At least one city must be selected"),selectedYear:h().required("Please select a starting year."),Staff:h().required("Please select a number of staff."),labourCount:h().required("Please select a current labour strength."),expertise:h().required("Please select a expertise."),mobNo:h().required("Mobile number is Required.").matches(/^[0-9]+$/,"Mobile number must contain only numbers").length(10,"Mobile number must be exactly 10 digits")});function Qe(){Ce();const $=localStorage.getItem("user"),b=JSON.parse($),[g,_]=n.exports.useState([]),[F,J]=n.exports.useState(!1),[u,C]=n.exports.useState({stateID:"",stateName:"",cityID:"",cityName:"",pincode:"",address:""}),[t,o]=n.exports.useState({userName:"",userRegID:b.user._id,firmName:"",firmRepresentative:"",firmType:"",representativeDesignation:"",representativeEducation:"",representativeQualification:"",mobile:"",alternateMobile:"",email:"",website:"",pincode:"",expertiseId:"",preferredCities:null,homeCity:"",yearOfEst:"",staffCount:"",labourCount:"",authorisedApplicators:"",panNo:"",pfNo:"",gstNo:"",remark:""}),[D,W]=n.exports.useState([]),[Fe,z]=n.exports.useState(),[De,K]=n.exports.useState([]),[w,X]=n.exports.useState([]),[f,I]=n.exports.useState([]),[we,Z]=n.exports.useState([]);n.exports.useState("");const[Re,ee]=n.exports.useState(""),[Oe,te]=n.exports.useState(""),[R,O]=n.exports.useState(!1),[T,A]=n.exports.useState(!1),[V,Y]=n.exports.useState(!1),[M,ae]=n.exports.useState(!1),[S,le]=n.exports.useState([]),[se,re]=n.exports.useState(!1),oe=()=>{ae(!M)},{register:c,formState:{errors:d},handleSubmit:Te}=Ee({resolver:Pe(j),mode:"all"}),B=e=>{const l={...t,address:u};console.log(117,"Data Posted",l),v.post("https://constrobackend17-4.onrender.com/api/post_service_provider",l).then(r=>{console.log(130,r.data),y.success("Submitted Successfully.")}).catch(r=>{console.error("API Error:",r.message),y.error("Submission failed. Please try again.")})},ne=e=>{const l={...t,address:u};console.log(117,"Data Posted",l),v.post("https://constrobackend17-4.onrender.com/api/post_service_provider",l).then(r=>{console.log(130,r.data),y.success("Submitted Successfully.")}).catch(r=>{console.error("API Error:",r.message),y.error("Submission failed. Please try again.")})},p=_e({initialValues:t||{firmName:"",firmRepresentative:"",representativeDesignation:"",userName:"",mobile:"",alternateMobile:"",email:"",website:"",pincode:"",homeCity:"",preferredCities:null,address:null,remark:"",userCode:"",categoryId:null,categoryType:"",stateID:null,regFrom:"",regOn:null,lastModified:"",year:"",firmType:""},validationSchema:j,onSubmit:B}),k=(e,l)=>{l(e.target.checked)},ie=1900,ce=2100,L="Ltd",q=2100,Q="Ltd",H=2100,U=[];for(let e=ie;e<=ce;e++)U.push(e);const de=["proprietor","partnership","LLP","Pvt Ltd","Ltd","HUF"],me=e=>{const l=e.target.value,r=e.target.name;te(l),console.log("Selected Category:",l),o({...t,[r]:l})},E=["Less than 5","5 - 10","10 - 20","20 - 50","50 - 100","100 - 200","More than 200"];n.exports.useEffect(()=>{b&&b.user&&b.user._id?(o({...t,userRegID:b.user._id}),v.get(`https://constrobackend17-4.onrender.com/api/get_service_provider_regid/${b.user._id}`).then(e=>{if(console.log(66,e),!e.data.Result)y.error(e.data.message);else{re(!0),console.log("Data Fetch",e.data.Result);const l=e.data.Result;localStorage.setItem("profile",JSON.stringify(l)),console.log("Show Data",l.firmName),I(l.preferredCities),C(l.address),O(!!l.gstNo),A(!!l.pfNo),Y(!!l.panNo),o({...t,userName:l.userName,userRegID:l.userRegID,firmName:l.firmName,firmRepresentative:l.firmRepresentative,firmType:l.firmType,representativeDesignation:l.representativeDesignation,representativeEducation:l.representativeEducation,representativeQualification:l.representativeQualification,mobile:l.mobile,alternateMobile:l.alternateMobile,email:l.email,website:l.website,pincode:l.pincode,expertiseId:l.expertiseId,preferredCities:l.preferredCities,homeCity:l.homeCity,yearOfEst:l.yearOfEst,staffCount:l.staffCount,labourCount:l.labourCount,authorisedApplicators:l.authorisedApplicators,panNo:l.panNo,pfNo:l.pfNo,gstNo:l.gstNo,remark:l.remark})}}).catch(e=>{console.log(e)})):console.error("Invalid user data:",b),v.get("https://constrobackend17-4.onrender.com/api/get_all_expertise").then(e=>{console.log(e.data.Result),W(e.data.Result)}).catch(e=>{console.error("Error fetching expertise data:",e)}),v.get("https://constrobackend17-4.onrender.com/api/getAll_Cities_ddl").then(e=>{console.log(112,e.data.Result),le(e.data.Result)}).catch(e=>{console.log(e)}),v.get("https://constrobackend17-4.onrender.com/api/getAll_States_ddl").then(e=>{X(e.data.Result)}).catch(e=>{console.log(e)})},[]);for(let e=Q;e<=H;e++)E.push(e);const ue=["Less than 25","25 - 50","50 - 100","100 - 200","200 - 400","400 - 800","More than 800"];for(let e=Q;e<=H;e++)E.push(e);const pe=e=>{const l=e.target.value,r=e.target.name;Z(l),console.log("Selected Category:",l),o({...t,[r]:l})},P=["Pre Graduate","Diploma","Graduate","Post Graduate","Other"];for(let e=L;e<=q;e++)P.push(e);for(let e=L;e<=q;e++)P.push(e);const he=e=>{const l=e.target.value,r=e.target.name;z(l),console.log("Selected firm type:",l),o({...t,[r]:l})},fe=e=>{const l=e.target.value,r=e.target.name;ee(l),console.log("Selected labour :",l),o({...t,[r]:l})},be=e=>{const l=e.target.value,r=e.target.name;K(l),console.log("Selected staff :",l),o({...t,[r]:l})},ge=e=>{const{value:l,checked:r}=e.target,N=D.find(i=>i._id===l);if(r)if(g.length<2){const i=[...g,N];_(i),o({...t,expertiseId:i.map(x=>x._id)})}else alert("You can only select up to two expertise.");else{const i=g.filter(x=>x._id!==l);_(i),o({...t,expertiseId:i.map(x=>x._id)})}},Ne=e=>{const l=e.target.value,r=S.find(N=>N._id===l);r?(console.log("Selected city:",r.city),o({...t,homeCity:r.city})):console.error("Error: Selected city not found")},ve=e=>{const{value:l,checked:r}=e.target,N=S.find(i=>i._id===l);if(r)if(f.length<3){const i=[...f,{cityId:l,cityName:N.city}];console.log(333,i),I(i),o({...t,preferredCities:i})}else alert("You can only select up to three cities.");else I(f.filter(i=>i.cityId!==l)),o({...t,preferredCities:f.filter(i=>i.cityId!==l).map(i=>i.cityId)})},xe=e=>{const l=e.target.value,r=w.filter(N=>N._id===l);console.log("Selected state:",r[0].state),C({...u,stateID:r[0]._id,stateName:r[0].state})},ye=()=>{J(!F)};return a("div",{children:s("div",{className:"row mt-3 shadow-md p-3",children:[a("span",{className:"my-4 text-lg font-semibold text-slate-500",children:"Basic details"}),a("div",{className:"text-base bg-black-100 text-slate-500  rounded-md",children:s("h6",{className:"text-sm rounded py-2 ",children:[a("b",{className:"text-red-400",children:"\xA0\xA0\xA0NOTE :"})," ",a("span",{className:"text-slate-400",children:"\xA0YOU CAN UPDATE YOUR PROFILE ONLY 3 TIMES."})]})}),s("div",{className:"col-lg-12 mt-3",children:[a("img",{className:"h-[90px] w-[90px] rounded-md opacity-60",src:Se,alt:""}),s("span",{className:"text-sm text-slate-400 font-normal",children:["Last Modified On : 15-Feb-2024"," "]}),a("form",{onSubmit:p.handleSubmit,children:s("div",{className:"row mt-3",children:[s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm name"}),a(m,{name:"firmName",type:"text",placeholder:"Firm name",register:c,error:d.firmName,className:"",value:t.firmName,defaultValue:t.firmName?t.firmName:"",onChange:e=>{o({...t,firmName:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[s("label",{for:"exampleInputPassword1",class:"form-label",children:["Representative",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),a(m,{name:"firmRepresentative",type:"text",placeholder:"",register:c,error:d.firmRepresentative,className:"",value:t.firmRepresentative,defaultValue:t.firmRepresentative?t.firmRepresentative:"",onChange:e=>{o({...t,firmRepresentative:e.target.value})}})]}),s("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"firmType",value:t.firmType,defaultValue:t.firmType?t.firmType:"",onChange:he,onBlur:p.handleBlur,children:[a("option",{value:"",children:"select Firm Type"}),de.map(e=>a("option",{value:e,children:e},e))]}),s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputPassword1",class:"form-label",children:"Designation"}),a(m,{name:"representativeDesignation",type:"text",placeholder:"",register:c,error:d.representativeDesignation,className:"",value:t.representativeDesignation,defaultValue:t.representativeDesignation?t.representativeDesignation:"",onChange:e=>{o({...t,representativeDesignation:e.target.value})}})]}),s("div",{className:"mb-3 col-lg-6",children:[a("label",{htmlFor:"exampleInputYear",className:"form-label",children:"Select Education"}),s("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"representativeEducation",value:t.representativeEducation,defaultValue:t.representativeEducation?t.representativeEducation:"",onChange:pe,onBlur:p.handleBlur,children:[a("option",{value:"",className:"",children:"Select Education"}),P.map(e=>a("option",{value:e,children:e},e))]})]}),s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputPassword1",class:"form-label",children:"Qualification"}),a(m,{name:"representativeQualification",type:"text",placeholder:"Qualification",register:c,error:d.representativeQualification,className:"",value:t.representativeQualification,defaultValue:t.representativeQualification?t.representativeQualification:"",onChange:e=>{o({...t,representativeQualification:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[s("label",{for:"exampleInputPassword1",class:"form-label",children:["Username",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),a(m,{name:"userName",type:"text",placeholder:"Username",register:c,error:d.userName,className:"",value:t.userName,defaultValue:t.userName?t.userName:"",onChange:e=>{o({...t,userName:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[s("label",{for:"exampleInputPassword1",class:"form-label",children:["Mobile Number",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),a(m,{name:"mobile",type:"number",placeholder:"Phone number",register:c,error:d.mobile,className:"",value:t.mobile,defaultValue:t.mobile?t.mobile:"",onChange:e=>{o({...t,mobile:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputPassword1",class:"form-label",children:"Alternate Mobile Number"}),a(m,{name:"alternateMobile",type:"number",placeholder:"Phone number",register:c,error:d.alternateMobile,className:"",value:t.alternateMobile,defaultValue:t.alternateMobile?t.alternateMobile:"",onChange:e=>{o({...t,alternateMobile:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputEmail1",class:"form-label",children:"Email address"}),a(m,{name:"email",type:"email",placeholder:" Enter your email",register:c,error:d.email,className:"",value:t.email,defaultValue:t.email?t.email:"",onChange:e=>{o({...t,email:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputEmail1",class:"form-label",children:"Website"}),a(m,{name:"website",type:"text",placeholder:"",register:c,error:d.website,className:"",value:t.website,defaultValue:t.website?t.website:"",onChange:e=>{o({...t,website:e.target.value})}})]}),s("div",{class:"mb-3 col-lg-6",children:[a("label",{for:"exampleInputEmail1",class:"form-label",children:"Pincode"}),a(m,{name:"pincode",type:"number",placeholder:"Pincode",register:c,error:d.pincode,className:"",value:u.pincode,defaultValue:u.pincode?u.pincode:"",onChange:e=>{C({...u,pincode:e.target.value})}})]}),s("div",{className:"mb-3 col-lg-6",children:[s("label",{htmlFor:"expertiseInput",className:"form-label",children:["Select Expertise",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),s("div",{className:"custom-select",style:{maxHeight:"150px",overflowY:"auto"},children:[a("input",{type:"text",className:"form-control bg-white",placeholder:"Select Expertise",value:g.map(e=>e.expertise).join(", "),readOnly:!0,onClick:ye}),F&&a("div",{className:"select-options my-2",children:D.map(e=>s("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"checkbox",id:e._id,value:e._id,checked:g.map(l=>l._id).includes(e._id),onChange:ge,disabled:g.length>=2&&!g.map(l=>l._id).includes(e._id)}),a("label",{className:"form-check-label text-sm",htmlFor:e.expertise,children:e.expertise})]},e._id))})]})]}),s("div",{className:"mb-3 col-lg-6",children:[s("label",{htmlFor:"cityInput",className:"form-label",children:["State",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),s("select",{className:"form-select text-sm text-slate-500",id:"exampleInputYear","aria-describedby":"emailHelp",name:"stateName",value:u.stateID,defaultValue:u.stateID?u.stateID:"",onChange:e=>xe(e),onBlur:p.handleBlur,children:[a("option",{value:"",children:"Select state"},""),w.map(e=>a("option",{value:e._id,children:e.state},e._id))]})]}),s("div",{className:"mb-3 col-lg-6",children:[s("label",{htmlFor:"cityInput",className:"form-label",children:["Home City",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),s("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"homeCity",value:t.homeCity,defaultValue:t.homeCity?t.homeCity:"",onChange:Ne,onBlur:p.handleBlur,children:[a("option",{value:"",children:"Select city"},""),S.map(e=>a("option",{value:e._id,children:e.city},e._id))]})]}),s("div",{className:"mb-3 col-lg-6",children:[a("label",{htmlFor:"cityInput",className:"form-label",children:"Operational Cities"}),s("div",{className:"custom-select",children:[a("input",{type:"text",className:"form-control bg-white",placeholder:"Select Cities",value:f.map(e=>e.cityName).join(", "),defaultValue:f.map(e=>e.cityName).join(", "),readOnly:!0,onClick:oe}),M&&a("div",{className:"select-options my-2",children:S.map(e=>s("div",{className:"form-check ",children:[a("input",{className:"form-check-input",type:"checkbox",id:e._id,value:e._id,checked:f.map(l=>l.cityId).includes(e._id),onChange:ve,disabled:f.length>=3&&!f.includes(e._id)}),a("label",{className:"form-check-label text-sm",htmlFor:e.city,children:e.city})]},e._id))})]})]}),s("div",{className:"mb-3 col-lg-6",children:[s("label",{htmlFor:"exampleInputYear",className:"form-label",children:["Established On",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),s("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"yearOfEst",value:t.yearOfEst,defaultValue:t.yearOfEst?t.yearOfEst:"",onChange:me,onBlur:p.handleBlur,children:[a("option",{value:"",className:"",children:"Select Year"}),U.map(e=>a("option",{value:e,children:e},e))]}),p.touched.year&&p.errors.year&&a("div",{className:"text-red-500 text-sm p-1",children:p.errors.year})]}),s("div",{class:"mb-3 col-lg-12",children:[a("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm Address"}),a(m,{name:"address",type:"text",placeholder:"Enter firm address..",register:c,error:d.address,className:"",value:u.address,defaultValue:u.address?u.address:"",onChange:e=>{C({...u,address:e.target.value})}})]}),s("div",{className:"mb-3 col-lg-6",children:[s("label",{htmlFor:"exampleInputYear",className:"form-label",children:["Number Of Staff",a("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),s("select",{className:"form-select text-sm",id:"exampleInputYear",name:"staffCount","aria-describedby":"emailHelp",value:t.staffCount,defaultValue:t.staffCount?t.staffCount:"",onChange:be,onBlur:p.handleBlur,children:[a("option",{value:"",className:"",children:"Select Number Of Staff"}),E.map(e=>a("option",{value:e,children:e},e))]}),p.touched.staffCount&&p.errors.staffCount&&a("div",{className:"text-red-500 text-sm p-1",children:p.errors.staffCount})]}),s("div",{className:"mb-3 col-lg-6",children:[a("label",{htmlFor:"exampleInputYear",className:"form-label",children:"Currunt Labour Strength"}),s("select",{className:"form-select text-sm",id:"exampleInputYear",name:"labourCount","aria-describedby":"emailHelp",value:t.labourCount,defaultValue:t.labourCount?t.labourCount:"",onChange:fe,onBlur:p.handleBlur,children:[a("option",{value:"",className:"",children:"Select Labour Strength"}),ue.map(e=>a("option",{value:e,children:e},e))]})]}),s("div",{className:"mb-3 col-lg-12 flex items-center gap-4",children:[s("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"checkbox",value:"",checked:!!V,id:"flexCheckPAN",onChange:e=>k(e,Y)}),a("label",{className:"form-check-label text-sm font-medium",htmlFor:"flexCheckPAN",children:"PAN Number"})]}),s("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"checkbox",value:"",checked:!!R,id:"flexCheckGST",onChange:e=>k(e,O)}),a("label",{className:"form-check-label text-sm font-medium",htmlFor:"flexCheckGST",children:"GST Number"})]}),s("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"checkbox",value:"",checked:!!T,id:"flexCheckPF",onChange:e=>k(e,A)}),a("label",{className:"form-check-label text-sm font-medium",htmlFor:"flexCheckPF",children:"PF Number"})]})]}),R&&a("div",{className:"mb-3 col-lg-7",children:a(m,{name:"gstNo",type:"text",placeholder:"Enter GST Number",register:c,error:d.gstNo,className:"",value:t.gstNo,defaultValue:t.gstNo?t.gstNo:"",onChange:e=>{o({...t,gstNo:e.target.value})}})}),T&&a("div",{className:"mb-3 col-lg-7",children:a(m,{name:"pfNo",type:"number",placeholder:"Enter PF Number",register:c,error:d.pfNo,className:"",value:t.pfNo,defaultValue:t.pfNo?t.pfNo:"",onChange:e=>{o({...t,pfNo:e.target.value})}})}),V&&a("div",{className:"mb-3 col-lg-7",children:a(m,{name:"panNo",type:"number",placeholder:"Enter PAN Number",register:c,error:d.panNo,className:"",value:t.panNo,defaultValue:t.panNo?t.panNo:"",onChange:e=>{o({...t,panNo:e.target.value})}})}),s("div",{class:"mb-3 col-lg-12",children:[a("label",{for:"exampleInputEmail1",class:"form-label",children:"Remark"}),a(m,{name:"remark",type:"text",placeholder:"",register:c,error:d.remark,className:"",value:t.remark,defaultValue:t.remark?t.remark:"",onChange:e=>{o({...t,remark:e.target.value})},id:"floatingTextarea2"})]}),se?a(G,{children:a("button",{type:"submit",class:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:e=>ne(),children:"Update"})}):a(G,{children:a("button",{type:"submit",class:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:e=>B(),children:"Submit"})})]})})]})]})})}export{Qe as default};
