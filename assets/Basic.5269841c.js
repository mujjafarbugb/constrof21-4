import{u as D,r as i,Q as y,j as r,a as l,F as S}from"./index.81de7608.js";import"./index.esm.b0dae23c.js";import{c as ee}from"./camPic.50111723.js";import{c as te,a as x,u as ae,o as le}from"./array.c4379bca.js";import{T as u}from"./Textinput.5c99e78c.js";import{u as re}from"./formik.esm.a73e9a74.js";import{a as b}from"./axios.74c9240f.js";import"./index.474f4860.js";const O=te({firmRepresentative:x().required("Feild is Required."),userName:x().required("Username is Required."),homeCity:x().required("Home city is Required."),mobile:x().required("Mobile number is Required.").matches(/^[0-9]+$/,"Mobile number must contain only numbers").length(10,"Mobile number must be exactly 10 digits")}),be=()=>{D();const T=localStorage.getItem("user"),g=JSON.parse(T),[o,v]=i.exports.useState({stateID:"",stateName:"",cityID:"",cityName:"",pincode:"",address:""}),[a,n]=i.exports.useState({userRegID:g.user._id,userName:"",homeCity:"",profile:"",mobile:"",alternateMobile:"",email:"",password:"",categoryId:"",categoryType:"",firmName:"",firmType:"",firmRepresentative:"",representativeDesignation:"",website:"",preferredCities:"",yearOfEst:"",remark:"",fcmToken:"",regFrom:"",regOn:"",lastModified:"",isActive:!0});i.exports.useState("");const[E,P]=i.exports.useState(),[se,F]=i.exports.useState(""),[p,C]=i.exports.useState([]);i.exports.useState([]),i.exports.useState(),i.exports.useState([]);const[k,M]=i.exports.useState([]),[N,V]=i.exports.useState([]),[ie,Y]=i.exports.useState([]),[A,U]=i.exports.useState(),[_,B]=i.exports.useState(!1),[q,H]=i.exports.useState(!1),[I,R]=i.exports.useState(!1),L=1900,j=2100;i.exports.useEffect(()=>{g&&g.user&&g.user._id?(n({...a,userRegID:g.user._id}),b.get(`https://constrobackend17-4.onrender.com/api/get_service_receiver_userregId/${g.user._id}`).then(t=>{if(console.log(66,t),!t.data.Result)y.error(t.data.message);else{H(!0);const e=t.data.Result;localStorage.setItem("profile",JSON.stringify(e)),console.log(96,e),P(e.updateCount),U(e._id),C(e.preferredCities),v(e.address),n({...a,firmName:e==null?void 0:e.firmName,userName:e==null?void 0:e.userName,homeCity:e==null?void 0:e.homeCity,profile:e==null?void 0:e.profile,mobile:e==null?void 0:e.mobile,alternateMobile:e==null?void 0:e.alternateMobile,email:e==null?void 0:e.email,password:e==null?void 0:e.password,categoryId:e==null?void 0:e.categoryId,categoryType:e==null?void 0:e.categoryType,firmType:e==null?void 0:e.firmType,firmRepresentative:e==null?void 0:e.firmRepresentative,representativeDesignation:e==null?void 0:e.representativeDesignation,website:e==null?void 0:e.website,preferredCities:e==null?void 0:e.preferredCities,yearOfEst:e==null?void 0:e.yearOfEst,remark:e==null?void 0:e.remark,fcmToken:e==null?void 0:e.fcmToken,regFrom:e==null?void 0:e.regFrom,regOn:e==null?void 0:e.regOn})}}).catch(t=>{console.log(t)})):console.error("Invalid user data:",g),b.get("https://constrobackend17-4.onrender.com/api/getAll_States_ddl").then(t=>{M(t.data.Result)}).catch(t=>{console.log(t)}),b.get("https://constrobackend17-4.onrender.com/api/getAll_Cities_ddl").then(t=>{console.log(112,t.data.Result),V(t.data.Result)}).catch(t=>{console.log(t)}),b.get("https://constrobackend17-4.onrender.com/api/get_all_categories").then(t=>{console.log(1,t.data.Result),Y(t.data.Result)}).catch(t=>{console.log(t)})},[I]);const $=t=>{console.log(62,a),console.log(63,o);const e={...a,address:o};console.log(117,"Data Posted",e),e&&b.post("https://constrobackend17-4.onrender.com/api/post_service_receiver",e).then(s=>{s.data,console.log(130,s.data),y.success("Submitted Successfully."),R(!I)}).catch(s=>{console.error("API Error:",s.message),y.error("Submission failed. Please try again.")})},J=t=>{console.log(62,a),console.log(63,o);const e={...a,address:o};console.log(117,"Data Posted",e),e&&b.put(`https://constrobackend17-4.onrender.com/api/update_service_receiver/${A}`,e).then(s=>{s.data,console.log(130,s.data),y.success(s.data.message),R(!I)}).catch(s=>{console.error("API Error:",s.message),y.error("Submission failed. Please try again.")})},{register:m,formState:{errors:d},handleSubmit:oe}=ae({resolver:le(O),mode:"all"}),h=re({initialValues:{firmName:"",firmRepresentative:"",representativeDesignation:"",userName:"",mobile:"",alternateMobile:"",email:"",website:"",pincode:"",homeCity:"",preferredCities:null,address:null,remark:"",userCode:"",categoryId:null,categoryType:"",stateID:null,stateName:null,regFrom:"",regOn:null,lastModified:"",year:"",firmType:""},validationSchema:O,onSubmit:t=>{console.log(122,t)}}),w=[];for(let t=L;t<=j;t++)w.push(t);const W=t=>{const e=t.target.value,s=t.target.name;F(e),console.log("Selected Category:",e),n({...a,[s]:e})},Q=t=>{const e=t.target.value,s=k.filter(f=>f._id===e);console.log("Selected state:",s[0].state),v({...o,stateID:s[0]._id,stateName:s[0].state})},z=()=>{B(!_)},G=t=>{const{value:e,checked:s}=t.target,f=N.find(c=>c._id===e);if(s)if(p.length<3){const c=[...p,{cityId:e,cityName:f.city}];console.log(333,c),C(c),n({...a,preferredCities:c})}else alert("You can only select up to three cities.");else C(p.filter(c=>c.cityId!==e)),n({...a,preferredCities:p.filter(c=>c.cityId!==e).map(c=>c.cityId)})},K=t=>{const e=t.target.value;console.log(e);const s=N.find(f=>f._id===e);console.log(s),s?(console.log("Selected city:",s.city),v({...o,cityID:s._id,cityName:s.city})):console.error("Error: Selected city not found")},X=["proprietor","partnership","LLP","Pvt Ltd","Ltd","HUF"],Z=t=>{const e=t.target.value,s=t.target.name;console.log("Selected firm type:",e),n({...a,[s]:e})};return r("div",{className:"shadow-md p-4",children:[l("span",{className:"my-4 text-lg font-semibold text-slate-500",children:"Basic details"}),l("div",{className:"text-base bg-black-100 text-slate-500  rounded-md",children:r("h6",{className:"text-sm rounded py-2 ",children:[l("b",{className:"text-red-400",children:"\xA0\xA0\xA0NOTE :"})," ",l("span",{className:"text-slate-400",children:"\xA0YOU CAN UPDATE YOUR PROFILE ONLY 3 TIMES."})]})}),l("div",{className:"row mt-3",children:r("div",{className:"col-lg-12",children:[l("img",{className:"h-[90px] w-[90px] rounded-md opacity-60",src:ee,alt:""}),r("span",{className:"text-sm text-slate-400 font-normal",children:["Last Modified On : 15-Feb-2024"," "]}),l("form",{onSubmit:h.handleSubmit,children:r("div",{className:"row mt-3",children:[r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm name"}),l(u,{name:"firmName",type:"text",placeholder:"Firm name",register:m,error:d.firmName,className:"",value:a.firmName,defaultValue:a.firmName?a.firmName:"",onChange:t=>{n({...a,firmName:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputPassword1",class:"form-label",children:"Representative"}),l(u,{name:"firmRepresentative",type:"text",placeholder:"Representative",register:m,error:d.firmRepresentative,className:"",value:a.firmRepresentative,defaultValue:a.firmRepresentative?a.firmRepresentative:"",onChange:t=>{n({...a,firmRepresentative:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputPassword1",class:"form-label",children:"Designation"}),l(u,{name:"representativeDesignation",type:"text",placeholder:"Enter designation",register:m,error:d.representativeDesignation,className:"",value:a.representativeDesignation,defaultValue:a.representativeDesignation?a.representativeDesignation:"",onChange:t=>{n({...a,representativeDesignation:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Username",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),l(u,{name:"userName",type:"text",placeholder:"Username",register:m,error:d.userName,className:"",value:a.userName,defaultValue:a.userName?a.userName:"",onChange:t=>{n({...a,userName:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Mobile Number",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),l(u,{name:"mobile",type:"text",placeholder:"Phone number",register:m,error:d.mobile,className:"",value:a.mobile,defaultValue:a.mobile?a.mobile:"",onChange:t=>{n({...a,mobile:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputPassword1",class:"form-label",children:"Alternate Mobile Number"}),l(u,{name:"alternateMobile",type:"text",placeholder:"Phone number",register:m,error:d.alternateMobile,className:"",value:a.alternateMobile,defaultValue:a.alternateMobile?a.alternateMobile:"",onChange:t=>{n({...a,alternateMobile:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Email address"}),l(u,{name:"email",type:"email",placeholder:" Enter your email",register:m,error:d.email,className:"",value:a.email,defaultValue:a.email?a.email:"",onChange:t=>{n({...a,email:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Website"}),l(u,{name:"website",type:"text",placeholder:"Website link",register:m,error:d.website,className:"",value:a.website,defaultValue:a.website?a.website:"",onChange:t=>{n({...a,website:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Pincode"}),l(u,{name:"pincode",type:"number",placeholder:"Pincode",register:m,error:d.pincode,className:"",value:o.pincode,defaultValue:o.pincode?o.pincode:"",onChange:t=>{v({...o,pincode:t.target.value})}})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["State",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm text-slate-500",id:"exampleInputYear","aria-describedby":"emailHelp",name:"stateName",value:o.stateID,defaultValue:o.stateID?o.stateID:"",onChange:t=>Q(t),onBlur:h.handleBlur,children:[l("option",{value:"",children:"Select state"},""),k.map(t=>l("option",{value:t._id,children:t.state},t._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["Home City",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm text-slate-500",id:"exampleInputYear","aria-describedby":"emailHelp",name:"homeCity",value:o.cityID,defaultValue:o.cityID,onChange:K,onBlur:h.handleBlur,children:[l("option",{value:"",className:"",children:"Select City"},""),N.map(t=>l("option",{value:t._id,children:t.city},t._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[l("label",{htmlFor:"cityInput",className:"form-label",children:"Operational Cities"}),r("div",{className:"custom-select",children:[l("input",{type:"text",className:"form-control bg-white",placeholder:"Select Cities",value:p.map(t=>t.cityName).join(", "),defaultValue:p.map(t=>t.cityName).join(", "),readOnly:!0,onClick:z}),_&&l("div",{className:"select-options my-2",children:N.map(t=>r("div",{className:"form-check ",children:[l("input",{className:"form-check-input",type:"checkbox",id:t._id,value:t._id,checked:p.map(e=>e.cityId).includes(t._id),onChange:G,disabled:p.length>=3&&!p.includes(t._id)}),l("label",{className:"form-check-label text-sm",htmlFor:t.city,children:t.city})]},t._id))})]})]}),r("div",{className:"mb-3 col-lg-6",children:[l("label",{htmlFor:"exampleInputYear",className:"form-label",children:"Starting Year"}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"yearOfEst",value:a.yearOfEst,defaultValue:a.yearOfEst,onChange:W,onBlur:h.handleBlur,children:[l("option",{value:"",className:"",children:"Select Year"}),w.map(t=>l("option",{value:t,children:t},t))]}),h.touched.year&&h.errors.year&&l("div",{className:"text-red-500 text-sm p-1",children:h.errors.year})]}),r("div",{className:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm Type"}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"firmType",value:a.firmType,defaultValue:a.firmType?a.firmType:"",onChange:Z,onBlur:h.handleBlur,children:[l("option",{value:"",children:"select Firm Type"}),X.map(t=>l("option",{value:t,children:t},t))]})]}),r("div",{className:"mb-3 col-lg-12",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Remark"}),l(u,{name:"remark",type:"text",placeholder:"",register:m,error:d.remark,className:"",value:a.remark,defaultValue:a.remark,onChange:t=>{n({...a,remark:t.target.value})},id:"floatingTextarea2"})]}),q?l(S,{children:E<3&&l(S,{children:l("button",{type:"submit",className:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:t=>J(),children:"Update"})})}):l(S,{children:l("button",{type:"submit",className:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:t=>$(),children:"Submit"})})]})})]})})]})};export{be as default};
